<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>æ¥µé™æ£’çƒé™£å®¹å¤§å¸«</title>
<script src="https://cdn.tailwindcss.com"></script>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
<style>
body{font-family:'Noto Sans TC',sans-serif;background-color:#020617;color:#f8fafc;overflow-x:hidden;-webkit-tap-highlight-color:transparent}
.baseball-field{background:radial-gradient(circle at center,#16a34a 0%,#14532d 100%);position:relative;aspect-ratio:1/1;border-radius:10% 10% 50% 50%;border:4px solid #064e3b;box-shadow:inset 0 0 60px rgba(0,0,0,0.6)}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:#1e293b}::-webkit-scrollbar-thumb{background:#475569;border-radius:2px}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.animate-slide-up{animation:slideUp 0.3s ease-out forwards}
.card-shadow{box-shadow:0 10px 25px -5px rgba(0,0,0,0.4),0 8px 10px -6px rgba(0,0,0,0.4)}
.diamond-inner{position:absolute;left:50%;top:55%;width:42%;height:42%;border:2px solid rgba(255,255,255,0.15);transform:translate(-50%,-50%) rotate(45deg);pointer-events:none}
.sync-indicator{display:inline-block;width:8px;height:8px;border-radius:50%;background-color:#10b981;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
</style>
</head>
<body>
<div id="root"></div>
<script type="module">
import{initializeApp}from'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import{getFirestore,doc,setDoc,onSnapshot}from'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
const firebaseConfig={apiKey:"AIzaSyAwmH0zHsXFWP7Lt5RtSgbJCRljtMOwAL8",authDomain:"baseball-roster-manager-71b72.firebaseapp.com",projectId:"baseball-roster-manager-71b72",storageBucket:"baseball-roster-manager-71b72.firebasestorage.app",messagingSenderId:"423902203072",appId:"1:423902203072:web:a670744b7d08a53bcab125",measurementId:"G-XVBBJ63WQ2"};
const app=initializeApp(firebaseConfig);const db=getFirestore(app);
window.firebaseDB=db;window.firebaseDoc=doc;window.firebaseSetDoc=setDoc;window.firebaseOnSnapshot=onSnapshot;
console.log('âœ… Firebase å·²åˆå§‹åŒ–');
</script>
<script type="text/babel">
const{useState,useEffect,useMemo,useRef}=React;
const ALL_POSITIONS=['P','C','1B','2B','3B','SS','LF','CF','RF','FE','DH1','DH2','DH3'];
const POSITION_OPTIONS=['P','C','1B','2B','3B','SS','LF','CF','RF','FE','DH'];
const GRADE_OPTIONS=['S','A','B','C','D','E','F'];
const STAT_NAMES=['hitting','power','discipline','speed','defense','accuracy','armStrength','iq'];
const STAT_LABELS={hitting:'æ‰“æ“Š',power:'åŠ›é‡',discipline:'é¸çƒ',speed:'é€Ÿåº¦',defense:'å®ˆå‚™',accuracy:'å‚³æº–',armStrength:'è‡‚åŠ›',iq:'çƒå•†'};
const DEFAULT_PLAYERS=[
  {id:'1',name:'ç‹å¤§å¼·',number:'1',primaryPosition:'P',secondaryPositions:['DH'],grades:{hitting:'C',power:'C',discipline:'C',speed:'C',defense:'A',accuracy:'A',armStrength:'B',iq:'A'},willAttend:true,points:80},
  {id:'2',name:'æé‡ç ²',number:'24',primaryPosition:'RF',secondaryPositions:['1B','DH'],grades:{hitting:'A',power:'S',discipline:'B',speed:'D',defense:'C',accuracy:'B',armStrength:'A',iq:'B'},willAttend:true,points:90}
];

const getGradeColor=(grade)=>{
  const colors={
    S:'from-purple-400 to-purple-600',
    A:'from-yellow-300 to-yellow-500',
    B:'from-sky-300 to-blue-400',
    C:'from-orange-300 to-orange-500',
    D:'from-green-300 to-green-500',
    E:'from-white to-slate-100',
    F:'from-white to-slate-100'
  };
  return colors[grade]||colors.F
};

const getCardRarity=(grades)=>{
  const gradeValues={S:7,A:6,B:5,C:4,D:3,E:2,F:1};
  const values=Object.values(grades).map(g=>gradeValues[g]||1);
  const avg=values.reduce((a,b)=>a+b,0)/values.length;
  if(avg>=6)return'from-purple-400 to-purple-600';
  if(avg>=5)return'from-yellow-300 to-amber-500';
  if(avg>=4)return'from-sky-300 to-blue-400';
  if(avg>=3)return'from-gray-300 to-slate-400';
  if(avg>=2)return'from-white to-slate-100';
  return'from-white to-slate-100'
};

const GradeBar=({label,grade})=>(<div className="flex items-center gap-2"><span className="text-[8px] font-black text-white/70 w-8">{label}</span><div className={`px-2 py-0.5 rounded text-[10px] font-black bg-gradient-to-r text-slate-900 ${getGradeColor(grade)}`}>{grade}</div></div>);

const PlayerCard=({player,onClick,selected,showGrades=true,compact=false,showSecondary=true})=>{
  if(!player)return null;
  const rarity=getCardRarity(player.grades);
  if(compact){
    return(<div onClick={onClick}className={`p-3 rounded-xl border-2 flex items-center gap-3 ${onClick?'cursor-pointer':''} transition-all active:scale-95 bg-gradient-to-br ${rarity} shadow-md border-white/10 ${!player.willAttend?'opacity-40':''}`}><span className="text-[10px] font-black opacity-60">#{player.number}</span><span className="text-sm font-black truncate flex-1 text-slate-900">{player.name}</span><span className="text-[9px] font-black bg-black/30 px-2 py-0.5 rounded uppercase text-white">{player.primaryPosition}</span></div>)
  }
  return(<div onClick={onClick}className={`relative flex flex-col p-4 rounded-2xl border-2 transition-all ${onClick?'cursor-pointer':''} active:scale-95 bg-gradient-to-br ${rarity} border-white/10 card-shadow ${selected?'ring-4 ring-cyan-400 border-white':''} ${!player.willAttend?'opacity-40':''}`}><div className="flex justify-between items-start mb-2 relative z-10"><div className="flex flex-col"><span className="text-[10px] font-black uppercase opacity-70 text-slate-900">No.{player.number}</span><h3 className="text-lg font-black drop-shadow-md leading-tight text-slate-900">{player.name}</h3></div><div className="bg-black/30 px-2 py-1 rounded-lg font-black text-[11px] text-white">{player.primaryPosition}</div></div>{showSecondary&&player.secondaryPositions&&player.secondaryPositions.length>0&&(<div className="flex flex-wrap gap-1 mb-3 relative z-10">{player.secondaryPositions.map(pos=>(<span key={pos}className="text-[8px] bg-white/30 px-2 py-0.5 rounded font-bold uppercase text-slate-900">{pos}</span>))}</div>)}{showGrades&&(<div className="grid grid-cols-2 gap-x-2 gap-y-1 mt-auto">{STAT_NAMES.map(stat=><GradeBar key={stat}label={STAT_LABELS[stat]}grade={player.grades[stat]}/>)}</div>)}</div>)
};

const App=()=>{
  const[activeTab,setActiveTab]=useState('field');
  const[players,setPlayers]=useState(DEFAULT_PLAYERS);
  const[lineup,setLineup]=useState({});
  const[battingOrder,setBattingOrder]=useState([]);
  const[pitcherBats,setPitcherBats]=useState(false);
  const[selectingPosition,setSelectingPosition]=useState(null);
  const[editingPlayer,setEditingPlayer]=useState(null);
  const[isLoading,setIsLoading]=useState(true);
  const[isSynced,setIsSynced]=useState(false);
  const isUpdatingFromFirebase=useRef(false);
  const[rotations,setRotations]=useState([]);
  const[editingSlot,setEditingSlot]=useState(null);
  const[copyNotification,setCopyNotification]=useState('');
  
  useEffect(()=>{
    if(!window.firebaseDB){console.error('âŒ Firebase æœªåˆå§‹åŒ–');setIsLoading(false);return}
    const docRef=window.firebaseDoc(window.firebaseDB,"baseballData","current");
    const unsubscribe=window.firebaseOnSnapshot(docRef,(snapshot)=>{
      if(snapshot.exists()){
        const data=snapshot.data();
        isUpdatingFromFirebase.current=true;
        setPlayers(data.players||DEFAULT_PLAYERS);
        setLineup(data.lineup||{});
        setBattingOrder(data.battingOrder||[]);
        setPitcherBats(data.pitcherBats||false);
        setRotations(data.rotations||[]);
        setIsSynced(true);
        setTimeout(()=>{isUpdatingFromFirebase.current=false},100)
      }else{
        const defaultData={players:DEFAULT_PLAYERS,lineup:{},battingOrder:[],pitcherBats:false,rotations:[]};
        saveToFirebase(defaultData)
      }
      setIsLoading(false)
    },(error)=>{console.error("âŒ Firebase éŒ¯èª¤:",error);setIsLoading(false)});
    return()=>unsubscribe()
  },[]);
  
  const saveToFirebase=async(data)=>{
    if(isUpdatingFromFirebase.current)return;
    if(!window.firebaseDB)return;
    try{
      const docRef=window.firebaseDoc(window.firebaseDB,"baseballData","current");
      await window.firebaseSetDoc(docRef,{
        players:data.players!==undefined?data.players:players,
        lineup:data.lineup!==undefined?data.lineup:lineup,
        battingOrder:data.battingOrder!==undefined?data.battingOrder:battingOrder,
        pitcherBats:data.pitcherBats!==undefined?data.pitcherBats:pitcherBats,
        rotations:data.rotations!==undefined?data.rotations:rotations,
        lastUpdated:new Date()
      });
      setIsSynced(true)
    }catch(error){console.error("âŒ å„²å­˜å¤±æ•—:",error);setIsSynced(false)}
  };
  
  useEffect(()=>{
    if(!isLoading&&!isUpdatingFromFirebase.current){
      saveToFirebase({players,lineup,battingOrder,pitcherBats,rotations})
    }
  },[players,lineup,battingOrder,pitcherBats,rotations]);
  
  useEffect(()=>{
    const onField=Object.entries(lineup).filter(([pos,pid])=>pid);
    let currentOrder=battingOrder.filter(e=>{
      const pos=Object.keys(lineup).find(k=>lineup[k]===e.playerId);
      return pos&&(pitcherBats||pos!=='P')
    });
    const orderIds=new Set(currentOrder.map(e=>e.playerId));
    const missing=onField.filter(([pos,pid])=>!orderIds.has(pid)&&(pitcherBats||pos!=='P')).map(([pos,pid])=>({playerId:pid,position:pos}));
    if(missing.length>0){
      setBattingOrder(prev=>[...currentOrder,...missing])
    }else if(currentOrder.length!==battingOrder.length){
      setBattingOrder(currentOrder)
    }
  },[lineup,pitcherBats]);
  
  const handleDeletePlayer=(id)=>{
    if(!window.confirm('ç¢ºå®šè¦åˆªé™¤é€™ä½çƒå“¡å—ï¼Ÿ'))return;
    setPlayers(prev=>prev.filter(p=>p.id!==id));
    setLineup(prev=>{const next={...prev};Object.keys(next).forEach(key=>{if(next[key]===id)delete next[key]});return next});
    setBattingOrder(prev=>prev.filter(item=>item.playerId!==id))
  };
  
  const handleDeleteAll=()=>{
    if(!window.confirm('ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰çƒå“¡å—ï¼Ÿ'))return;
    setPlayers([]);setLineup({});setBattingOrder([]);setRotations([])
  };
  
  const handleToggleAllAttendance=(attend)=>{
    setPlayers(prev=>prev.map(p=>({...p,willAttend:attend})))
  };
  
  const availablePlayers=useMemo(()=>players.filter(p=>p.willAttend),[players]);
  const bench=useMemo(()=>{const assigned=new Set(Object.values(lineup));return availablePlayers.filter(p=>!assigned.has(p.id))},[availablePlayers,lineup]);
  const battingSubstitutes=useMemo(()=>{const inLineup=new Set(battingOrder.map(e=>e.playerId));return availablePlayers.filter(p=>!inLineup.has(p.id))},[availablePlayers,battingOrder]);
  
  const sortedPlayersForSelection=useMemo(()=>{
    if(!selectingPosition)return[];
    const onOtherPos=new Set(Object.entries(lineup).filter(([pos,pid])=>pos!==selectingPosition&&pid).map(([pos,pid])=>pid));
    return[...availablePlayers].filter(p=>!onOtherPos.has(p.id)).sort((a,b)=>{
      const getPriority=(p)=>{
        if(p.primaryPosition===selectingPosition)return 0;
        if(p.secondaryPositions?.includes(selectingPosition))return 1;
        if(selectingPosition.match(/^DH/)&&p.secondaryPositions?.includes('DH'))return 1;
        return 2
      };
      const pA=getPriority(a),pB=getPriority(b);
      if(pA!==pB)return pA-pB;
      if(b.points!==a.points)return b.points-a.points;
      const gradeValues={S:7,A:6,B:5,C:4,D:3,E:2,F:1};
      const avgA=Object.values(a.grades).reduce((sum,g)=>sum+gradeValues[g],0)/8;
      const avgB=Object.values(b.grades).reduce((sum,g)=>sum+gradeValues[g],0)/8;
      return avgB-avgA
    })
  },[availablePlayers,lineup,selectingPosition]);
  
  const autoOptimizeBatting=()=>{
    const activeOnField=Object.entries(lineup).filter(([pos,pid])=>pid&&(pitcherBats||pos!=='P')).map(([pos,pid])=>({pos,player:availablePlayers.find(p=>p.id===pid)})).filter(x=>x.player);
    if(activeOnField.length===0)return;
    const gradeValues={S:7,A:6,B:5,C:4,D:3,E:2,F:1};
    let pool=[...activeOnField];
    let optimized=[];
    pool.sort((a,b)=>(gradeValues[b.player.grades.speed]*1.5+gradeValues[b.player.grades.hitting]+b.player.points*0.1)-(gradeValues[a.player.grades.speed]*1.5+gradeValues[a.player.grades.hitting]+a.player.points*0.1));
    for(let i=0;i<2&&pool.length>0;i++)optimized.push(pool.shift());
    pool.sort((a,b)=>(gradeValues[b.player.grades.power]*1.5+gradeValues[b.player.grades.hitting]+b.player.points*0.1)-(gradeValues[a.player.grades.power]*1.5+gradeValues[a.player.grades.hitting]+a.player.points*0.1));
    for(let i=0;i<3&&pool.length>0;i++)optimized.push(pool.shift());
    pool.sort((a,b)=>gradeValues[b.player.grades.hitting]+b.player.points*0.1-(gradeValues[a.player.grades.hitting]+a.player.points*0.1));
    optimized=[...optimized,...pool];
    setBattingOrder(optimized.map(item=>({playerId:item.player.id,position:item.pos})))
  };
  
  const copyLineupText=()=>{
    let text='';
    battingOrder.forEach((item,idx)=>{
      const p=availablePlayers.find(x=>x.id===item.playerId);
      const displayPos=item.position.match(/^DH/)?'DH':item.position;
      text+=`${idx+1}. ${p?.name||'?'} ${displayPos}\n`
    });
    const pitcher=Object.entries(lineup).find(([pos,pid])=>pos==='P'&&pid);
    if(pitcher&&!pitcherBats){
      const p=availablePlayers.find(x=>x.id===pitcher[1]);
      text+=`\nSP ${p?.name||'?'}`
    }
    try{
      navigator.clipboard.writeText(text);
      setCopyNotification(text);
      setTimeout(()=>setCopyNotification(''),5000)
    }catch(err){
      setCopyNotification('è¤‡è£½å¤±æ•—ï¼š'+err.message);
      setTimeout(()=>setCopyNotification(''),5000)
    }
  };
  
  const autoOptimizeDefense=(mode)=>{
    if(!window.confirm(`ä½¿ç”¨ã€Œ${mode}ã€æ¨¡å¼è‡ªå‹•æœ€ä½³åŒ–å®ˆå‚™ä½ç½®ï¼Ÿ`))return;
    const gradeValues={S:7,A:6,B:5,C:4,D:3,E:2,F:1};
    const newLineup={};
    const assigned=new Set();
    const sortedPlayers=[...availablePlayers].sort((a,b)=>{
      if(b.points!==a.points)return b.points-a.points;
      if(mode==='å®ˆå‚™æœ€ä½³åŒ–')return gradeValues[b.grades.defense]-gradeValues[a.grades.defense];
      if(mode==='æ‰“æ“Šæœ€å¤§åŒ–')return(gradeValues[b.grades.power]+gradeValues[b.grades.hitting])-(gradeValues[a.grades.power]+gradeValues[a.grades.hitting]);
      const avgB=Object.values(b.grades).reduce((sum,g)=>sum+gradeValues[g],0)/8;
      const avgA=Object.values(a.grades).reduce((sum,g)=>sum+gradeValues[g],0)/8;
      return avgB-avgA
    });
    ALL_POSITIONS.forEach(pos=>{
      const candidate=sortedPlayers.find(p=>{
        if(assigned.has(p.id))return false;
        if(mode==='å®ˆå‚™æœ€ä½³åŒ–'){
          if(p.primaryPosition===pos)return true;
          if(p.secondaryPositions?.includes(pos))return true;
          if(pos.match(/^DH/)&&p.secondaryPositions?.includes('DH'))return true;
          return false
        }
        if(p.primaryPosition===pos||p.secondaryPositions?.includes(pos))return true;
        if(pos.match(/^DH/)&&p.secondaryPositions?.includes('DH'))return true;
        return false
      });
      if(candidate){newLineup[pos]=candidate.id;assigned.add(candidate.id)}
    });
    setLineup(newLineup)
  };
  
  const handleExportExcel=()=>{
    const data=players.map(p=>({
      'å§“å':p.name,'èƒŒè™Ÿ':p.number,'ä¸»è¦ä½ç½®':p.primaryPosition,'æ¬¡è¦ä½ç½®':p.secondaryPositions?.join(','),
      ...STAT_NAMES.reduce((obj,stat)=>{obj[STAT_LABELS[stat]]=p.grades[stat];return obj},{}),
      'æœƒåˆ°å ´':p.willAttend?'æ˜¯':'å¦','ç©åˆ†':p.points||0
    }));
    const ws=XLSX.utils.json_to_sheet(data);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb,ws,"çƒå“¡åå†Š");
    XLSX.writeFile(wb,"Roster_Master.xlsx")
  };
  
  const handleImportExcel=(e)=>{
    const file=e.target.files[0];
    if(!file)return;
    const r=new FileReader();
    r.onload=(evt)=>{
      const ws=XLSX.read(evt.target.result,{type:'binary'}).Sheets[XLSX.read(evt.target.result,{type:'binary'}).SheetNames[0]];
      const data=XLSX.utils.sheet_to_json(ws);
      setPlayers(prev=>[...prev,...data.map((d,i)=>{
        const grades={};
        STAT_NAMES.forEach(stat=>{grades[stat]=d[STAT_LABELS[stat]]||'C'});
        return{
          id:'imp-'+Date.now()+i,
          name:d.å§“å||'çƒå“¡',
          number:String(d.èƒŒè™Ÿ||'0'),
          primaryPosition:d.ä¸»è¦ä½ç½®||'P',
          secondaryPositions:d.æ¬¡è¦ä½ç½®?String(d.æ¬¡è¦ä½ç½®).split(','):[],
          grades,
          willAttend:d.æœƒåˆ°å ´==='æ˜¯',
          points:d.ç©åˆ†||50
        }
      })])
    };
    r.readAsBinaryString(file)
  };
  
  const assignPlayer=(pid)=>{
    const nl={...lineup};
    Object.keys(nl).forEach(k=>{if(nl[k]===pid)delete nl[k]});
    nl[selectingPosition]=pid;
    setLineup(nl);
    setSelectingPosition(null)
  };
  
  const renderFieldSlot=(pos,top,left)=>{
    const p=availablePlayers.find(x=>x.id===lineup[pos]);
    return(<div key={pos}onClick={()=>setSelectingPosition(pos)}className="absolute transform -translate-x-1/2 -translate-y-1/2 z-20 cursor-pointer"style={{top,left}}><div className={`w-14 h-14 md:w-16 md:h-16 rounded-full border-2 flex flex-col items-center justify-center transition-all ${p?'bg-slate-900 border-yellow-400 scale-110 shadow-lg':'bg-black/30 border-white/20'}`}><span className="text-[10px] font-black opacity-50">{pos}</span><span className="text-[11px] font-bold truncate px-1 text-white">{p?p.name:'+'}</span></div></div>)
  };
  
  const addRotation=()=>{
    if(battingOrder.length===0)return alert('è«‹å…ˆè¨­å®šæ‰“ç·š');
    const newRot={id:Date.now().toString(),name:`ç¬¬${rotations.length+1}å±€`,lineup:{...lineup},battingOrder:[...battingOrder]};
    setRotations(prev=>[...prev,newRot])
  };
  
  const duplicateRotation=(rot)=>{
    const newRot={id:Date.now().toString(),name:`${rot.name}(è¤‡è£½)`,lineup:{...rot.lineup},battingOrder:[...rot.battingOrder]};
    setRotations(prev=>[...prev,newRot])
  };
  
  const deleteRotation=(id)=>{
    if(!window.confirm('ç¢ºå®šåˆªé™¤æ­¤é™£å®¹ï¼Ÿ'))return;
    setRotations(prev=>prev.filter(r=>r.id!==id))
  };
  
  const updateRotationName=(id,name)=>{
    setRotations(prev=>prev.map(r=>r.id===id?{...r,name}:r))
  };
  
  const getPrevRotation=(idx)=>idx>0?rotations[idx-1]:null;
  
  const swapPositions=(rotId,slotIdx,targetPlayerId)=>{
    setRotations(prev=>prev.map(rot=>{
      if(rot.id!==rotId)return rot;
      const currentItem=rot.battingOrder[slotIdx];
      const targetIdx=rot.battingOrder.findIndex(item=>item.playerId===targetPlayerId);
      if(targetIdx===-1){
        const newOrder=[...rot.battingOrder];
        const pitcherPos='P';
        newOrder[slotIdx]={...currentItem,position:pitcherPos};
        const newLineup={...rot.lineup};
        newLineup[pitcherPos]=currentItem.playerId;
        newLineup[currentItem.position]=targetPlayerId;
        return{...rot,battingOrder:newOrder,lineup:newLineup}
      }
      const newOrder=[...rot.battingOrder];
      const targetItem=newOrder[targetIdx];
      newOrder[slotIdx]={...currentItem,position:targetItem.position};
      newOrder[targetIdx]={...targetItem,position:currentItem.position};
      const newLineup={...rot.lineup};
      newLineup[targetItem.position]=currentItem.playerId;
      newLineup[currentItem.position]=targetPlayerId;
      return{...rot,battingOrder:newOrder,lineup:newLineup}
    }));
    setEditingSlot(null)
  };
  
  const substitutePlayer=(rotId,slotIdx,newPlayerId)=>{
    setRotations(prev=>prev.map(rot=>{
      if(rot.id!==rotId)return rot;
      const currentItem=rot.battingOrder[slotIdx];
      const newOrder=[...rot.battingOrder];
      newOrder[slotIdx]={...currentItem,playerId:newPlayerId};
      const newLineup={...rot.lineup};
      newLineup[currentItem.position]=newPlayerId;
      return{...rot,battingOrder:newOrder,lineup:newLineup}
    }));
    setEditingSlot(null)
  };
  
  const substitutePitcher=(rotId,newPitcherId)=>{
    setRotations(prev=>prev.map(rot=>{
      if(rot.id!==rotId)return rot;
      const newLineup={...rot.lineup};
      newLineup.P=newPitcherId;
      return{...rot,lineup:newLineup}
    }));
    setEditingSlot(null)
  };
  
  if(isLoading){
    return(<div className="max-w-7xl mx-auto bg-slate-950 min-h-screen flex items-center justify-center"><div className="text-center"><div className="animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-400 mx-auto mb-4"></div><p className="text-slate-400 font-bold">è¼‰å…¥ä¸­...</p></div></div>)
  }
  
  return(<div className="min-h-screen pb-32 max-w-7xl mx-auto bg-slate-950 shadow-2xl relative border-x border-white/5"><header className="sticky top-0 z-40 bg-slate-900/95 backdrop-blur-md border-b border-white/10 p-5 shadow-lg flex justify-between items-center"><h1 className="text-2xl font-black italic tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 to-indigo-600 uppercase">Pro Manager</h1><div className="flex items-center gap-3">{isSynced&&(<div className="flex items-center gap-1.5 text-xs text-emerald-400 bg-emerald-950/50 px-2 py-1 rounded-full border border-emerald-800"><span className="sync-indicator"></span>å·²åŒæ­¥</div>)}<div className="text-[10px] font-black text-slate-500 uppercase px-3 py-1 bg-slate-900 rounded-full border border-white/10">Active:{availablePlayers.length}/{players.length}</div></div></header><main className="p-4 sm:p-6">{activeTab==='field'&&(<div className="animate-slide-up space-y-8"><div className="bg-slate-900 p-4 rounded-3xl border border-white/10 shadow-xl mb-6"><h2 className="font-black italic text-cyan-400 uppercase tracking-widest text-sm mb-3">Defense Setup</h2><div className="flex gap-2 flex-wrap">{['å®ˆå‚™æœ€ä½³åŒ–','æ‰“æ“Šæœ€å¤§åŒ–','å¹³è¡¡æ¨¡å¼'].map(mode=>(<button key={mode}onClick={()=>autoOptimizeDefense(mode)}className="text-[10px] font-black bg-purple-700/50 text-purple-400 px-4 py-2 rounded-full border border-purple-500/30 active:scale-95 shadow-lg">{mode}</button>))}</div></div><div className="baseball-field relative overflow-hidden card-shadow mx-auto max-w-[450px]"><div className="diamond-inner"/>{ALL_POSITIONS.slice(0,10).map((pos,i)=>{const coords=[{t:'55%',l:'50%'},{t:'78%',l:'50%'},{t:'45%',l:'82%'},{t:'25%',l:'65%'},{t:'45%',l:'18%'},{t:'25%',l:'35%'},{t:'15%',l:'15%'},{t:'8%',l:'50%'},{t:'15%',l:'85%'},{t:'35%',l:'50%'}][i];return renderFieldSlot(pos,coords.t,coords.l)})}</div><div className="grid grid-cols-3 gap-3">{['DH1','DH2','DH3'].map(dh=>(<div key={dh}onClick={()=>setSelectingPosition(dh)}className={`p-4 rounded-2xl border-2 flex flex-col items-center justify-center transition-all cursor-pointer ${lineup[dh]?'bg-indigo-900/80 border-indigo-400 shadow-md':'bg-slate-900 border-slate-800 opacity-60'}`}><span className="text-[10px] text-white/40 font-black mb-1 uppercase">{dh}</span><span className="text-sm font-black truncate text-white">{availablePlayers.find(x=>x.id===lineup[dh])?.name||'---'}</span></div>))}</div><div className="pt-6 border-t border-white/5"><h3 className="text-[10px] font-black text-slate-500 mb-4 uppercase tracking-widest px-1">æ¿å‡³çƒå“¡(Bench)</h3><div className="grid grid-cols-2 md:grid-cols-4 gap-3">{bench.length>0?bench.map(p=><PlayerCard key={p.id}player={p}compact/>):<p className="col-span-full text-center text-xs text-slate-700 py-6 font-bold uppercase tracking-widest">Empty Bench</p>}</div></div></div>)}{activeTab==='batting'&&(<div className="animate-slide-up space-y-6"><div className="bg-slate-900 p-5 rounded-3xl border border-white/10 flex justify-between items-center shadow-xl"><h2 className="font-black italic text-cyan-400 uppercase tracking-widest text-sm">Lineup Builder</h2><div className="flex gap-4 items-center"><button onClick={copyLineupText}className="text-[10px] font-black bg-indigo-700/50 text-indigo-400 px-4 py-2 rounded-full border border-indigo-500/30 active:scale-95 shadow-lg">ğŸ“‹ è¤‡è£½æ‰“åº</button><button onClick={autoOptimizeBatting}className="text-[10px] font-black bg-cyan-700/50 text-cyan-400 px-4 py-2 rounded-full border border-cyan-500/30 active:scale-95 shadow-lg">ğŸª„ è‡ªå‹•æœ€ä½³åŒ–</button><label className="flex items-center gap-2 text-[11px] text-slate-400 font-black uppercase cursor-pointer"><input type="checkbox"checked={pitcherBats}onChange={e=>setPitcherBats(e.target.checked)}className="accent-cyan-500"/>P Bats</label></div></div><div className="grid grid-cols-1 md:grid-cols-2 gap-6"><div className="space-y-2">{battingOrder.length>0?battingOrder.map((e,i)=>{const displayPos=e.position.match(/^DH/)?'DH':e.position;return(<div key={i}className="flex items-center gap-4 bg-slate-900/80 p-4 rounded-2xl border border-white/5 shadow-md"><div className="w-9 h-9 flex items-center justify-center bg-slate-950 rounded-xl font-black text-cyan-400 border border-cyan-900/30 text-lg">{i+1}</div><div className="flex-1"><span className="font-black text-base text-white">{availablePlayers.find(p=>p.id===e.playerId)?.name}</span><span className="text-[10px] text-slate-500 ml-3 uppercase font-black">{displayPos}</span></div><div className="flex gap-2"><button onClick={()=>{const n=[...battingOrder];if(i>0)[n[i],n[i-1]]=[n[i-1],n[i]];setBattingOrder(n)}}className="p-3 bg-slate-800 rounded-xl active:bg-slate-700">â–²</button><button onClick={()=>{const n=[...battingOrder];if(i<n.length-1)[n[i],n[i+1]]=[n[i+1],n[i]];setBattingOrder(n)}}className="p-3 bg-slate-800 rounded-xl active:bg-slate-700">â–¼</button></div></div>)}):<p className="text-center text-sm text-slate-700 py-16 font-black border-2 border-dashed border-slate-900 rounded-[2rem] uppercase tracking-widest">Build Lineup First</p>}</div><div className="space-y-4"><h3 className="text-[11px] font-black text-slate-500 uppercase tracking-widest px-1">Substitute Pool</h3><div className="grid grid-cols-1 sm:grid-cols-2 gap-3">{battingSubstitutes.map(p=><PlayerCard key={p.id}player={p}compact/>)}</div></div></div></div>)}{activeTab==='rotation'&&(<div className="animate-slide-up space-y-6"><div className="bg-slate-900 p-5 rounded-3xl border border-white/10 flex justify-between items-center shadow-xl"><h2 className="font-black italic text-cyan-400 uppercase tracking-widest text-sm">Rotation Management</h2><button onClick={addRotation}className="text-[10px] font-black bg-emerald-700/50 text-emerald-400 px-4 py-2 rounded-full border border-emerald-500/30 active:scale-95 shadow-lg">ï¼‹ æ–°å¢é™£å®¹</button></div><div className="overflow-x-auto"><div className="flex gap-2 pb-4"style={{minWidth:'max-content'}}>{rotations.map((rot,idx)=>{const prevRot=getPrevRotation(idx);const pitcherInLineup=pitcherBats;const rotBench=availablePlayers.filter(p=>!Object.values(rot.lineup).includes(p.id));return(<div key={rot.id}className="bg-slate-900/60 rounded-2xl border border-white/10 p-2.5 w-32 flex-shrink-0"><div className="flex justify-between items-center mb-2"><input value={rot.name}onChange={e=>updateRotationName(rot.id,e.target.value)}className="bg-transparent font-black text-[10px] text-cyan-400 outline-none border-b border-cyan-800 px-1 w-16"/><div className="flex gap-0.5"><button onClick={()=>duplicateRotation(rot)}className="text-[9px] p-0.5 bg-slate-800 rounded">ğŸ“‹</button><button onClick={()=>deleteRotation(rot.id)}className="text-[9px] p-0.5 bg-red-900/50 rounded">ğŸ—‘ï¸</button></div></div><div className="space-y-0.5 mb-2">{rot.battingOrder.map((item,bidx)=>{const p=availablePlayers.find(x=>x.id===item.playerId);const prevItem=prevRot?.battingOrder[bidx];const playerChanged=prevItem&&prevItem.playerId!==item.playerId;const posChanged=prevItem&&prevItem.position!==item.position;const changed=playerChanged||posChanged;const displayPos=item.position.match(/^DH/)?'DH':item.position;return(<div key={bidx}onClick={()=>setEditingSlot({rotId:rot.id,slotIdx:bidx,currentPlayerId:item.playerId,currentPosition:item.position,rotation:rot,isPitcher:false})}className={`text-[10px] p-1 rounded flex items-center cursor-pointer hover:bg-slate-700/50 ${changed?'bg-yellow-600/50 border border-yellow-500/70':'bg-slate-800/50'}`}><span className="font-bold text-slate-400 text-[9px] w-3">{bidx+1}</span><span className="font-black flex-1 ml-1 truncate text-[10px]">{p?.name||'?'}</span><span className="text-[8px] font-bold text-slate-500">{displayPos}</span></div>)})}{!pitcherInLineup&&(<><div className="border-t border-slate-700 my-1"></div>{Object.entries(rot.lineup).filter(([pos,pid])=>pos==='P'&&pid).map(([pos,pid])=>{const p=availablePlayers.find(x=>x.id===pid);const prevP=prevRot?.lineup?.P;const changed=prevP&&prevP!==pid;return(<div key={pos}onClick={()=>setEditingSlot({rotId:rot.id,currentPlayerId:pid,rotation:rot,isPitcher:true})}className={`text-[10px] p-1 rounded flex items-center cursor-pointer hover:bg-slate-700/50 ${changed?'bg-yellow-600/50 border border-yellow-500/70':'bg-slate-800/50'}`}><span className="font-black flex-1 truncate text-[10px]">{p?.name||'?'}</span><span className="text-[8px] font-bold text-slate-500">{pos}</span></div>)})}</>)}</div><div className="border-t border-slate-700 pt-1.5"><h4 className="text-[7px] font-black text-slate-600 uppercase mb-1">Bench</h4><div className="space-y-0.5">{rotBench.slice(0,3).map(p=>(<div key={p.id}className="text-[8px] p-0.5 bg-slate-950/50 rounded text-slate-400 truncate">{p.name}</div>))}{rotBench.length>3&&<div className="text-[7px] text-slate-600">+{rotBench.length-3}</div>}</div></div></div>)})}</div></div></div>)}{activeTab==='roster'&&(<div className="animate-slide-up space-y-6"><div className="bg-slate-900 p-6 rounded-3xl border border-white/10 grid grid-cols-2 gap-3 shadow-xl"><button onClick={()=>setEditingPlayer({secondaryPositions:[],grades:STAT_NAMES.reduce((obj,stat)=>{obj[stat]='C';return obj},{}),willAttend:true,points:50})}className="col-span-2 bg-cyan-600 py-4 rounded-2xl text-sm font-black shadow-lg uppercase tracking-widest active:scale-95 transition-all">ï¼‹ Add New Player</button><button onClick={handleExportExcel}className="bg-slate-800 py-3.5 rounded-2xl text-[11px] font-black uppercase tracking-widest shadow-md">ğŸ“¥ Export</button><label className="bg-slate-800 py-3.5 rounded-2xl text-[11px] font-black text-center cursor-pointer uppercase tracking-widest shadow-md">ğŸ“¤ Import<input type="file"className="hidden"accept=".xlsx,.xls"onChange={handleImportExcel}/></label><button onClick={()=>handleToggleAllAttendance(true)}className="bg-emerald-800 py-3.5 rounded-2xl text-[11px] font-black uppercase tracking-widest shadow-md">âœ… å…¨éƒ¨å‡ºå¸­</button><button onClick={()=>handleToggleAllAttendance(false)}className="bg-orange-800 py-3.5 rounded-2xl text-[11px] font-black uppercase tracking-widest shadow-md">âŒ å…¨ä¸å‡ºå¸­</button><button onClick={handleDeleteAll}className="col-span-2 bg-red-900 py-3.5 rounded-2xl text-[11px] font-black uppercase tracking-widest shadow-md">ğŸ—‘ï¸ åˆªé™¤å…¨éƒ¨</button></div><div className="grid grid-cols-1 sm:grid-cols-2 gap-4">{players.map(p=>(<div key={p.id}className="relative group"><div onClick={()=>setEditingPlayer(p)}className="cursor-pointer"><PlayerCard player={p}/></div><button onClick={(e)=>{e.stopPropagation();handleDeletePlayer(p.id)}}className="absolute -top-1 -right-1 bg-red-600 w-8 h-8 rounded-full text-white font-black text-lg shadow-xl z-30 transition-all active:scale-90 flex items-center justify-center cursor-pointer border-2 border-white">Ã—</button></div>))}</div></div>)}</main><nav className="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-7xl bg-slate-900/95 backdrop-blur-2xl border-t border-white/10 flex justify-around items-center h-24 px-4 pb-6 pt-2 z-40">{[{id:'field',icon:'ğŸŸï¸',label:'Field'},{id:'batting',icon:'âš¡',label:'Lineup'},{id:'rotation',icon:'ğŸ”„',label:'Rotation'},{id:'roster',icon:'ğŸ“‡',label:'Roster'}].map(t=>(<button key={t.id}onClick={()=>setActiveTab(t.id)}className={`flex-1 flex flex-col items-center gap-2 transition-all ${activeTab===t.id?'text-cyan-400 scale-110 font-black':'text-slate-500 opacity-60'}`}><span className="text-2xl">{t.icon}</span><span className="text-[10px] font-black uppercase tracking-widest">{t.label}</span></button>))}</nav>{copyNotification&&(<div className="fixed top-20 left-1/2 -translate-x-1/2 z-50 bg-emerald-900 border-2 border-emerald-500 rounded-2xl p-4 shadow-2xl max-w-sm animate-slide-up"><h4 className="font-black text-emerald-400 mb-2 text-sm">âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿</h4><pre className="text-xs text-white whitespace-pre-wrap font-mono bg-black/30 p-3 rounded-xl max-h-60 overflow-y-auto">{copyNotification}</pre></div>)}{selectingPosition&&(<div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/95 p-0 sm:p-4 backdrop-blur-md"><div className="bg-slate-900 w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] border-t-2 sm:border-2 border-white/10 p-8 shadow-2xl overflow-y-auto max-h-[85vh]"><div className="flex justify-between items-center mb-8"><h3 className="font-black text-2xl uppercase tracking-widest text-white">Select <span className="text-cyan-400">{selectingPosition}</span></h3><button onClick={()=>setSelectingPosition(null)}className="text-4xl font-black text-slate-600">Ã—</button></div><div className="space-y-4 pb-12">{sortedPlayersForSelection.length>0?sortedPlayersForSelection.map(p=>(<PlayerCard key={p.id}player={p}selected={lineup[selectingPosition]===p.id}onClick={()=>assignPlayer(p.id)}/>)):<p className="text-center py-24 text-slate-700 font-black italic uppercase tracking-widest">No available players</p>}<button onClick={()=>{const nl={...lineup};delete nl[selectingPosition];setLineup(nl);setSelectingPosition(null)}}className="w-full py-5 rounded-3xl bg-slate-800/80 text-red-500 font-black mt-6 uppercase tracking-widest shadow-lg">Clear Position</button></div></div></div>)}{editingPlayer&&(<div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/98 backdrop-blur-2xl overflow-y-auto"><div className="bg-slate-900 w-full max-w-md rounded-[3rem] border-2 border-white/10 p-10 shadow-2xl my-8"><h3 className="text-2xl font-black mb-8 text-center italic uppercase tracking-tighter text-cyan-400">Player Profile</h3><div className="space-y-6"><div className="space-y-1.5"><label className="text-[11px] font-black text-cyan-500 uppercase tracking-widest ml-1">Name</label><input value={editingPlayer.name||''}onChange={e=>setEditingPlayer({...editingPlayer,name:e.target.value})}className="w-full bg-slate-800 rounded-3xl px-6 py-3.5 text-white font-black outline-none border border-white/5 focus:border-cyan-500 transition-all text-lg shadow-inner"placeholder="Enter name"/></div><div className="grid grid-cols-2 gap-5"><div className="space-y-1.5"><label className="text-[11px] font-black text-cyan-500 uppercase ml-1"># Number</label><input value={editingPlayer.number||''}onChange={e=>setEditingPlayer({...editingPlayer,number:e.target.value})}className="w-full bg-slate-800 rounded-3xl px-6 py-3.5 font-black outline-none border border-white/5 shadow-inner"/></div><div className="space-y-1.5"><label className="text-[11px] font-black text-cyan-500 uppercase ml-1">Primary Pos</label><select value={editingPlayer.primaryPosition||'P'}onChange={e=>setEditingPlayer({...editingPlayer,primaryPosition:e.target.value})}className="w-full bg-slate-800 rounded-3xl px-6 py-3.5 font-black outline-none border border-white/5 shadow-inner appearance-none">{POSITION_OPTIONS.map(p=><option key={p}value={p}>{p}</option>)}</select></div></div><div className="grid grid-cols-2 gap-5"><div onClick={()=>setEditingPlayer(p=>({...p,willAttend:!p.willAttend}))}className={`p-3 rounded-xl cursor-pointer border-2 flex items-center justify-center ${editingPlayer.willAttend?'bg-emerald-900/30 border-emerald-500':'bg-slate-800 border-slate-700'}`}><span className="text-sm font-black">{editingPlayer.willAttend?'âœ… æœƒåˆ°å ´':'âŒ ä¸åˆ°å ´'}</span></div><div className="space-y-1.5"><label className="text-[11px] font-black text-cyan-500 uppercase ml-1">ç©åˆ†</label><input type="number"value={editingPlayer.points||50}onChange={e=>setEditingPlayer({...editingPlayer,points:parseInt(e.target.value)||0})}className="w-full bg-slate-800 rounded-3xl px-6 py-3.5 font-black outline-none border border-white/5 shadow-inner"/></div></div><div className="space-y-3"><label className="text-[11px] font-black text-cyan-500 uppercase tracking-widest ml-1">Secondary Position</label><div className="grid grid-cols-4 gap-2">{POSITION_OPTIONS.map(pos=>{const isS=editingPlayer.secondaryPositions?.includes(pos);return<button key={pos}onClick={()=>{const c=editingPlayer.secondaryPositions||[];setEditingPlayer({...editingPlayer,secondaryPositions:isS?c.filter(x=>x!==pos):[...c,pos]})}}className={`text-[10px] font-black py-2 rounded-xl border transition-all ${isS?'bg-cyan-600 border-cyan-400 text-white shadow-lg':'bg-slate-800 border-slate-700 opacity-40 text-slate-500'}`}>{pos}</button>})}</div></div><div className="space-y-3 border-t border-white/10 pt-6"><label className="text-[11px] font-black text-cyan-500 uppercase tracking-widest ml-1">Grades</label><div className="grid grid-cols-2 gap-3">{STAT_NAMES.map(stat=><div key={stat}className="space-y-1"><label className="block text-[9px] font-black text-slate-500 uppercase">{STAT_LABELS[stat]}</label><select value={editingPlayer.grades?.[stat]||'C'}onChange={e=>setEditingPlayer({...editingPlayer,grades:{...(editingPlayer.grades||{}),[stat]:e.target.value}})}className="w-full bg-slate-800 rounded-xl px-3 py-2 font-black outline-none border border-white/5 text-sm">{GRADE_OPTIONS.map(g=><option key={g}value={g}>{g}</option>)}</select></div>)}</div></div></div><div className="flex gap-4 mt-10"><button onClick={()=>setEditingPlayer(null)}className="flex-1 py-4 rounded-3xl bg-slate-800 text-slate-500 font-black text-xs uppercase tracking-widest active:bg-slate-700 transition-all">Cancel</button><button onClick={()=>{if(!editingPlayer.name)return;const p={...editingPlayer,id:editingPlayer.id||Date.now().toString(),secondaryPositions:editingPlayer.secondaryPositions||[],grades:editingPlayer.grades||STAT_NAMES.reduce((obj,stat)=>{obj[stat]='C';return obj},{}),willAttend:editingPlayer.willAttend!==false,points:editingPlayer.points||50};if(editingPlayer.id)setPlayers(prev=>prev.map(x=>x.id===p.id?p:x));else setPlayers(prev=>[...prev,p]);setEditingPlayer(null)}}className="flex-1 py-4 rounded-3xl bg-cyan-600 text-white font-black text-xs shadow-xl uppercase tracking-widest transition-all active:scale-95">Save</button></div></div></div>)}{editingSlot&&(<div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/98 backdrop-blur-2xl"><div className="bg-slate-900 w-full max-w-2xl rounded-3xl border-2 border-white/10 p-6 shadow-2xl overflow-y-auto max-h-[90vh]"><h3 className="text-lg font-black mb-4 text-cyan-400">{editingSlot.isPitcher?'ç·¨è¼¯æŠ•æ‰‹':'ç·¨è¼¯æ‰“åº #'+(editingSlot.slotIdx+1)}</h3>{editingSlot.isPitcher?(<div className="space-y-3"><h4 className="text-xs font-black text-emerald-400 uppercase mb-2">ğŸ”€ æ›´æ›æŠ•æ‰‹</h4><div className="grid grid-cols-2 gap-2 max-h-96 overflow-y-auto">{availablePlayers.map(p=>(<div key={p.id}onClick={()=>substitutePitcher(editingSlot.rotId,p.id)}className="p-3 rounded-xl cursor-pointer border-2 bg-slate-800 border-slate-700 hover:bg-emerald-900/30 hover:border-emerald-500 transition-all"><div className="font-black text-sm">{p.name}</div><div className="text-xs text-slate-500">#{p.number} - {p.primaryPosition}</div></div>))}</div></div>):(<div className="grid grid-cols-2 gap-4"><div className="space-y-3"><h4 className="text-xs font-black text-purple-400 uppercase mb-2">ğŸ”„ å®ˆä½äº’æ›</h4><div className="space-y-2 max-h-96 overflow-y-auto pr-2">{editingSlot.rotation.battingOrder.filter(item=>item.playerId!==editingSlot.currentPlayerId).map((item,idx)=>{const p=availablePlayers.find(x=>x.id===item.playerId);const displayPos=item.position.match(/^DH/)?'DH':item.position;return(<div key={idx}onClick={()=>swapPositions(editingSlot.rotId,editingSlot.slotIdx,item.playerId)}className="p-3 rounded-xl cursor-pointer border-2 bg-slate-800 border-slate-700 hover:bg-purple-900/30 hover:border-purple-500 transition-all"><div className="font-black text-sm">{p?.name}</div><div className="text-xs text-slate-500">{displayPos}</div></div>)})}{editingSlot.rotation.lineup.P&&(<div onClick={()=>swapPositions(editingSlot.rotId,editingSlot.slotIdx,editingSlot.rotation.lineup.P)}className="p-3 rounded-xl cursor-pointer border-2 bg-slate-800 border-slate-700 hover:bg-purple-900/30 hover:border-purple-500 transition-all"><div className="font-black text-sm">{availablePlayers.find(x=>x.id===editingSlot.rotation.lineup.P)?.name}</div><div className="text-xs text-slate-500">P</div></div>)}</div></div><div className="space-y-3"><h4 className="text-xs font-black text-emerald-400 uppercase mb-2">ğŸ”€ æ›¿è£œä¸Šå ´</h4><div className="space-y-2 max-h-96 overflow-y-auto pr-2">{availablePlayers.filter(p=>!editingSlot.rotation.battingOrder.some(item=>item.playerId===p.id)&&p.id!==editingSlot.rotation.lineup.P).map(p=>(<div key={p.id}onClick={()=>substitutePlayer(editingSlot.rotId,editingSlot.slotIdx,p.id)}className="p-3 rounded-xl cursor-pointer border-2 bg-slate-800 border-slate-700 hover:bg-emerald-900/30 hover:border-emerald-500 transition-all"><div className="font-black text-sm">{p.name}</div><div className="text-xs text-slate-500">#{p.number} - {p.primaryPosition}</div></div>))}</div></div></div>)}<button onClick={()=>setEditingSlot(null)}className="w-full mt-6 py-3 rounded-2xl bg-slate-800 text-slate-400 font-black text-xs">å–æ¶ˆ</button></div></div>)}</div>)
};

const root=ReactDOM.createRoot(document.getElementById('root'));
root.render(<App/>);
</script>
</body>
</html>
