<!DOCTYPE html>
<html>
  <head>
    <title>新聞稿產生器</title>
    <style>
      #response {
        font-size: 12px;
        color: black;
      }
		textarea {
		  width: 70vw;
		  height: 30em;
		}


    </style>
  </head>
  <body>
    <h1>新聞稿產生器</h1>
    <textarea id="input">根據以下內容撰寫一篇新聞稿，包含一個標題，以及至少四段內容：
主題：
時間：
地點：
參考資料：
談話內容或評論：</textarea>
    <button id="submit">Submit</button>
    <textarea id="response" readonly></textarea>

    <script>
      const input = document.querySelector('#input');
      const submit = document.querySelector('#submit');
      const response = document.querySelector('#response');
      const API_KEY = ${{ secrets.API_KEY }};
      const API_URL = 'https://api.openai.com/v1/engines/text-davinci-003/completions';

      submit.addEventListener('click', () => {
        // Get the user's input
        const query = input.value;

        // Call the function to get a response from ChatGPT
        getResponseFromChatGPT(query).then((chatResponse) => {
          // Display the response
          response.value = chatResponse;
        });
      });

		async function getResponseFromChatGPT(query) {
		  // Show a message indicating that the response is being generated
		  response.value = "回答中...";

		  try {
		    // Make a request to the OpenAI API
		    const apiResponse = await fetch(API_URL, {
		      method: 'POST',
		      headers: {
		        'Content-Type': 'application/json',
		        'Authorization': `Bearer ${API_KEY}`
		      },
		      body: JSON.stringify({
		        prompt: query,
		        max_tokens: 2048
		      })
		    });

		    // Parse the JSON response
		    const json = await apiResponse.json();

		    // Return the response from ChatGPT
		    return json.choices[0].text;
		  } catch (error) {
		    // Display an error message indicating that the response could not be generated
		    response.value = "遇到錯誤：" + error;
		  }
		}


    </script>
  </body>
</html>
